<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.6"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>NEOC: Real</title>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="neocdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                   <a href="index.html"><img src="neoc_small.png" class="logostyle" alt="NEOC Icon" align="left"/></a>
                   <a class="navbar-brand" href="index.html">
                   NEOC 0.1</a>
                </div>
            <ul class="nav navbar-nav">
              <li><a href="index.html">Main Page</a></li>
              <li><a href="files.html">Files</a></li>
              <li class="dropdown">
                 <a href="annotated.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Data Structures<span class="caret"></span></a>
                   <ul class="dropdown-menu">
                      <li><a href="annotated.html">All Data Structures</a></li>
                      <li><a href="classes.html">Classes and Index</a></li>
                   </ul>
              </li>
              <li><a href="globals.html">Functions</a></li>
                <div style="float: right;">
                  <p class="navbar-text">By David Smerkous</p>
		</div>
              <li class="dropdown">
                 <a href="examples.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples<span class="caret"></span></a>
                   <ul class="dropdown-menu">
                      <li><a href="examples.html">All Examples</a></li>
                      <li class="menu-item dropdown dropdown-submenu"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Gpio</a>
                          <ul class="dropdown-menu">
                             <li class="menu-item"><a href="gpioblink.html">Blink</a></li>
                             <li class="menu-item"><a href="gpioread.html">Read</a></li>
                          </ul>
                      </li>
                      <li class="menu-item dropdown dropdown-submenu"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Pwm</a>
                          <ul class="dropdown-menu">
                             <li class="menu-item"><a href="examplepwm.html">Real Write</a></li>
                             <li class="menu-item"><a href="examplefakepwm.html">Fake Fade</a></li>
                          </ul>
                      </li>
                      <li class="menu-item dropdown dropdown-submenu"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Analog</a>
                          <ul class="dropdown-menu">
                             <li class="menu-item"><a href="exampleanalog.html">Read</a></li>
                          </ul>
                      </li>
                   </ul>
              </li>
            </ul>
            </div>        
	</nav>
        <div id="top"><!-- Other side of div is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
				<div id="MSearchResultsWindow">
				<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
				</iframe>
				</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Real </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>How to use the Real PWM controller to set a duty cycle</p>
<p>Please look at the pinout to find the PWM number on the bank (The pin isn't the same as GPIO) If you haven't yet make sure you go to the device tree editor and pinmux a pin to support PWM You must do this or you will recieve a NEO_UNUSABLE_ERROR when trying to write to that pin! The real PWM mapping to the pinmuxing is really weird and it's why the functions aren't mapped directly to the actual gpio pin. Sorry but you have to mess around with the pins before getting it to work. For now just try mapping PWM 5 on the device tree editor to GPIO bank pin 30 and trying the below sample code with PWM 0 If 0 shoots a NEO_UNUSABLE_ERROR. Try 1... and so forth.<br/>
<br/>
 Device Tree Tutorial: <a href="https://www.udoo.org/docs-neo/Cookbook_Linux/Device_Tree_Editor.html">https://www.udoo.org/docs-neo/Cookbook_Linux/Device_Tree_Editor.html</a></p>
<dl class="section warning"><dt>Warning</dt><dd>You must pinmux the proper PWM pin before continuing</dd></dl>
<p>Lets create a new file called pwmwrite.c (For C++ do pwmwrite.cpp) </p>
<div class="fragment"><div class="line">nano pwmwrite.c </div>
</div><!-- fragment --><h1><a class="anchor" id="examplec"></a>
C Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="neo_8h.html">neo.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Main funciton</span></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="pwm_8c.html#ac3ad9f77af407aee3e35a2fc2413d19d">neo_pwm_init</a>(); <span class="comment">//Must be called before using any other gpio pin function </span></div>
<div class="line"></div>
<div class="line">  <span class="comment">//neo_pwm_set_period(0, 20408); //OPTIONAL: Set a custom period time 20408 = ~49KHz</span></div>
<div class="line">  <span class="comment">//neo_pwm_set_period_all(20408); //OPTIONAL: Set for all the pins</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> ret = <a class="code" href="pwm_8c.html#adc47be04e8829bade2f04edd1b4e2cff">neo_pwm_write</a>(0, 127); <span class="comment">//Set pwm pin 0 (pwm 5) (IF YOU MAP PWM 5 to </span></div>
<div class="line">  <span class="comment">//GPIO pin 30 on device tree then pwm0 is pwm 5)  50% duty cycle (it&#39;s 0 to 255)</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(ret != <a class="code" href="neo_8h.html#abc7205d167c5e515159cb0f2b17cebea">NEO_OK</a>) {</div>
<div class="line">     printf(<span class="stringliteral">&quot;Failed writing to PWM!\nERROR: %d&quot;</span>, ret);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">//This will still run even when the program is finished... Just remember that</span></div>
<div class="line"></div>
<div class="line">  <a class="code" href="pwm_8c.html#a03628a77f1f0324fb0d7aff595be98ba">neo_pwm_free</a>(); <span class="comment">//Should be called to release the pins from the program (Called at end of program)</span></div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br/>
 </p>
<h1><a class="anchor" id="examplecpp"></a>
C++ Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="neo_8h.html">neo.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>neo; </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Main function</span></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code" href="classneo_1_1PWM.html">PWM</a> pwm(0); <span class="comment">//Start on PWM pin 0 (pwm 5) (NOT THE SAME AS GPIO MAPPING)      </span></div>
<div class="line">    <span class="comment">//pwm.setPeriod(20408); //Example set period</span></div>
<div class="line">    pwm.write(127);</div>
<div class="line">}</div>
</div><!-- fragment --><p> Warning The mapping of Real PWM is not the same as Gpio. Nor is it linear to the PWM mapping! (Read above) <br/>
 </p>
<h2><a class="anchor" id="compiling"></a>
Compiling and Running</h2>
<p>This is the example to compile and run the C version of neo </p>
<div class="fragment"><div class="line">gcc pwmwrite.c -I/usr/include -lneo -o pwmwrite</div>
<div class="line">chmod 755 pwmwrite</div>
<div class="line">./pwmwrite</div>
</div><!-- fragment --><p> <br/>
 The C++ version to compiling is nearly the same just replace gcc with g++ </p>
<div class="fragment"><div class="line">g++ pwmwrite.cpp -I/usr/include -lneo -o pwmwrite</div>
</div><!-- fragment --><p> <br/>
 </p>
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>Try hooking up an LED to that PWM pin and setting the PWM values at different points to see if the lighting changes If nothing changes make sure that pin supports REAL PWM, isn't failing to initialize it and it's been pinmuxed properly In the device tree editor </p>
</div></div><!-- contents -->

<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Created by David Smerkous &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="neoc_small.png" style="width: auto; height: 45px;" alt="NEOC Docs generated with Doxygen"/>
</a> Doxygen: 1.8.6
</small></address>
</body>
</html>
