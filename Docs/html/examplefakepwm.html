<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.12"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>NEOC: FakePWM</title>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="neocdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                   <a href="index.html"><img src="neoc_small.png" class="logostyle" alt="NEOC Icon" align="left"/></a>
                   <a class="navbar-brand" href="index.html">
                   NEOC 0.1</a>
                </div>
            <ul class="nav navbar-nav">
              <li><a href="index.html">Main Page</a></li>
              <li><a href="files.html">Files</a></li>
              <li class="dropdown">
                 <a href="annotated.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Data Structures<span class="caret"></span></a>
                   <ul class="dropdown-menu">
                      <li><a href="annotated.html">All Data Structures</a></li>
                      <li><a href="classes.html">Classes and Index</a></li>
                   </ul>
              </li>
              <li><a href="globals.html">Functions</a></li>
                <div style="float: right;">
                  <p class="navbar-text">By David Smerkous</p>
		</div>
              <li class="dropdown">
                 <a href="examples.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples<span class="caret"></span></a>
                   <ul class="dropdown-menu">
                      <li><a href="examples.html">All Examples</a></li>
                      <li class="menu-item dropdown dropdown-submenu"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Gpio</a>
                          <ul class="dropdown-menu">
                             <li class="menu-item"><a href="gpioblink.html">Blink</a></li>
                             <li class="menu-item"><a href="gpioread.html">Read</a></li>
                          </ul>
                      </li>
                      <li class="menu-item dropdown dropdown-submenu"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Pwm</a>
                          <ul class="dropdown-menu">
                             <li class="menu-item"><a href="examplepwm.html">Real Write</a></li>
                             <li class="menu-item"><a href="examplefakepwm.html">Fake Fade</a></li>
                          </ul>
                      </li>
                   </ul>
              </li>
            </ul>
            </div>        
	</nav>
        <div id="top"><!-- Other side of div is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
				<div id="MSearchResultsWindow">
				<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
				</iframe>
				</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FakePWM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>How to use PWM on any GPIO pin easily</p>
<p>This is a tutorial and example of how to use Fake PWM on any <a class="el" href="classGpio.html">Gpio</a> pin</p>
<p>Unlike the Real PWM this isn't as precise since it uses the processor clock and not a custom resolution clock This also is down to the speed of sysfs. I was able to do up to 100KHz (About half the period time of an arduino(p.s. that's good)) On about 30 pins, before the the led seemed to jitter at a visible amount. So I would recommend to leave it at 49KHz if using FakePWM on a lot of the pins. This is a lot easier to use than the Real PWM because it has the same mapping as the gpio since it uses the same methods in the backend. Try the example below for pin 13 which is the led.</p>
<p>Lets create a new file called fakefade.c (For C++ do fakefade.cpp) </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;nano fakefade.c </div></div><!-- fragment --><h1><a class="anchor" id="examplec"></a>
C Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor"> #include &lt;<a class="code" href="neo_8h.html">neo.h</a>&gt;</span></div><div class="line"><span class="preprocessor"> #include &lt;unistd.h&gt;</span></div><div class="line"><span class="preprocessor"> #include &lt;stdio.h&gt;</span></div><div class="line"></div><div class="line"> <span class="comment">//Main funciton</span></div><div class="line"> <span class="keywordtype">int</span> main() {</div><div class="line">   <a class="code" href="pwm_8c.html#a3eb536e6ed5e5019b0cd57b98b1059d3">neo_fake_pwm_init</a>(); <span class="comment">//Exactly the same as neo_gpio_init()</span></div><div class="line"></div><div class="line">   printf(<span class="stringliteral">&quot;Starting the fade\n&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordflow">while</span>(1) {</div><div class="line">      <span class="keywordtype">int</span> i;</div><div class="line">      <span class="comment">//Fade up to 255</span></div><div class="line">      <span class="keywordflow">for</span>(i = 0; i &lt; 255; i++) {</div><div class="line">         <a class="code" href="pwm_8c.html#a3481999a8f3514ddd7b8f357bf7234db">neo_fake_pwm_write</a>(13, i); <span class="comment">//Write up pwm value</span></div><div class="line">         usleep(1000*10); <span class="comment">//Wait 10millis</span></div><div class="line">      }</div><div class="line">      <span class="keywordtype">int</span> d;</div><div class="line">      </div><div class="line">      <span class="comment">//Fade down back to 0</span></div><div class="line">      <span class="keywordflow">for</span>(d = 255; d &gt; 0; d--) {</div><div class="line">         <a class="code" href="pwm_8c.html#a3481999a8f3514ddd7b8f357bf7234db">neo_fake_pwm_write</a>(13, d); <span class="comment">//Write down pwm value</span></div><div class="line">         usleep(1000*10); <span class="comment">//Wait 10millis</span></div><div class="line">      }</div><div class="line">         usleep(1000*400); <span class="comment">//Stay low 400 more millis</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">//neo_gpio_free(); &lt;- This should be called on end of program </span></div><div class="line">   <span class="keywordflow">return</span> 0; </div><div class="line">}</div></div><!-- fragment --><p> <br />
 </p>
<h1><a class="anchor" id="examplecpp"></a>
C++ Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor"> #include &lt;<a class="code" href="neo_8h.html">neo.h</a>&gt;</span></div><div class="line"><span class="preprocessor"> #include &lt;chrono&gt;</span></div><div class="line"><span class="preprocessor"> #include &lt;thread&gt;</span></div><div class="line"><span class="preprocessor"> #include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"> <span class="keyword">using namespace </span><a class="code" href="namespaceneo.html">neo</a>; </div><div class="line"> <span class="keyword">using namespace </span>std;</div><div class="line"></div><div class="line"> <span class="keywordtype">int</span> main() {</div><div class="line">   FakePWM fpwm(13); <span class="comment">//This will also init a static version of gpio</span></div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Starting the fade&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="keywordflow">while</span>(1) {</div><div class="line">      <span class="comment">//Fade up to 255</span></div><div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 255; i++) {</div><div class="line">         fpwm.write(i); <span class="comment">//Write up pwm value</span></div><div class="line">         this_thread::sleep_for(chrono::milliseconds(10));</div><div class="line">      }</div><div class="line">      </div><div class="line">      <span class="comment">//Fade down back to 0</span></div><div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d = 255; d &gt; 0; d--) {</div><div class="line">         fpwm.write(d); <span class="comment">//Write down pwm value</span></div><div class="line">         this_thread::sleep_for(chrono::milliseconds(10));</div><div class="line">      }</div><div class="line">         this_thread::sleep_for(chrono::milliseconds(400));</div><div class="line">   }</div><div class="line">   <span class="keywordflow">return</span> 0; </div><div class="line">}</div></div><!-- fragment --><p> <br />
 </p>
<h2><a class="anchor" id="compiling"></a>
Compiling and Running</h2>
<p>This is the example to compile and run the C version of neo </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;gcc fakefade.c -I/usr/include -lneo -o fakefade</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;chmod 755 fakefade</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;./fakefade</div></div><!-- fragment --><p> <br />
 The C++ version to compiling is nearly the same just replace gcc with g++ </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;g++ fakefade.cpp -I/usr/include -lneo -o fakefade</div></div><!-- fragment --><p> <br />
 </p>
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>Did you see pin 13 fading? Well if it worked without printing any errors you got the FakePWM to work now you can run PWM on any gpio pin available on the Udoo extremely easy. I don't know why I'm telling you this if you are on C and C++ and probably already know the expected results of the program. </p>
</div></div><!-- contents -->

<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Created by David Smerkous &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="neoc_small.png" style="width: auto; height: 45px;" alt="NEOC Docs generated with Doxygen"/>
</a> Doxygen: 1.8.12
</small></address>
</body>
</html>
